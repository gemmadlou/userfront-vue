{"version":3,"file":"userfront-vue.modern.js","sources":["../src/index.js"],"sourcesContent":["import Vue from \"vue\";\nimport AnyMod from \"@anymod/core\";\nimport Core from \"@userfront/core\";\n\nconst {\n  Singleton,\n  alias,\n  render,\n  processPage,\n  addScript1ToDocument,\n  createOrReturnPage,\n  checkPageAndUpdate,\n  executeCallbacks,\n  logErrorsAndTips,\n} = AnyMod;\n\nconst { registerUrlChangedEventListener, addInitCallback } = Core;\nalias.setAlias(\"Userfront\");\n\nSingleton.Opts.api = true;\n\n/**\n * The order of operations is:\n *  1. Userfront.init() is called\n *  2. Callback is fired that adds Script1 to document and sets Singleton.isScript1Loading = true\n *  3. Userfront.build() is called\n *  4. componentDidMount() is called\n *  5. mountTools() is called\n *  6a. If Script1 hasn't loaded yet, wait for it to load\n *  6b. If Script1 has loaded, continue\n *  7. runAnyModSetup() is called\n */\n\n// Callback to fire whenever Userfront.init is called\naddInitCallback(({ tenantId }) => {\n  Singleton.External.project = tenantId;\n  addScript1ToDocument(\n    \"https://cdn.userfront.com/toolkit/page/\",\n    tenantId,\n    runAnyModSetup\n  );\n});\n\nregisterUrlChangedEventListener();\n\nwindow.addEventListener(\"urlchanged\", render);\n\nasync function runAnyModSetup() {\n  if (Singleton.isScript1Loading) return;\n  const page = await createOrReturnPage();\n  const updatedPage = await checkPageAndUpdate(page);\n  await processPage(updatedPage);\n  executeCallbacks();\n  logErrorsAndTips();\n}\n\nasync function mountTools() {\n  try {\n    runAnyModSetup();\n  } catch (err) {\n    let message = err && err.message ? err.message : \"Problem loading page\";\n    console.warn(message, err);\n  }\n}\n\n/**\n * Returns a compiled Vue component.\n * Uses \"render\" instead of \"template\" to avoid runtime compiler:\n * https://vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only\n *\n * @param {Object} name - Vue component\n * @returns\n */\nexport function build(name) {\n  return Vue.component(name, {\n    props: {\n      toolId: {\n        type: String,\n        // required: true,\n      },\n    },\n    render(createElement) {\n      return createElement(\"div\", [\n        createElement(\"div\", {\n          attrs: {\n            id: `userfront-${this.toolId}`,\n          },\n        }),\n      ]);\n    },\n    async mounted() {\n      await mountTools();\n    },\n  });\n}\n\nexport const SignupForm = build(\"signup-form\");\nexport const LoginForm = build(\"login-form\");\nexport const PasswordResetForm = build(\"password-reset-form\");\nexport const LogoutButton = build(\"logout-button\");\n\nexport const Userfront = {\n  build,\n  SignupForm,\n  LoginForm,\n  PasswordResetForm,\n  LogoutButton,\n};\n\nfor (const attr in Core) {\n  if (!Userfront[attr]) Userfront[attr] = Core[attr];\n}\n\nexport default Userfront;\n"],"names":["Singleton","alias","render","processPage","addScript1ToDocument","createOrReturnPage","checkPageAndUpdate","executeCallbacks","logErrorsAndTips","AnyMod","registerUrlChangedEventListener","addInitCallback","Core","async","runAnyModSetup","isScript1Loading","page","updatedPage","build","name","Vue","component","props","toolId","type","String","createElement","attrs","id","this","[object Object]","err","console","warn","message","mountTools","setAlias","Opts","api","tenantId","External","project","window","addEventListener","SignupForm","LoginForm","PasswordResetForm","LogoutButton","Userfront","attr"],"mappings":"8EAIA,MAAMA,UACJA,EADIC,MAEJA,EAFIC,OAGJA,EAHIC,YAIJA,EAJIC,qBAKJA,EALIC,mBAMJA,EANIC,mBAOJA,EAPIC,iBAQJA,EARIC,iBASJA,GACEC,GAEEC,gCAAEA,EAAFC,gBAAmCA,GAAoBC,EA+B7DC,eAAeC,IACb,GAAId,EAAUe,iBAAkB,OAChC,MAAMC,QAAaX,IACbY,QAAoBX,EAAmBU,SACvCb,EAAYc,GAClBV,IACAC,aAoBcU,EAAMC,GACpB,OAAOC,EAAIC,UAAUF,EAAM,CACzBG,MAAO,CACLC,OAAQ,CACNC,KAAMC,SAIVvB,OAAOwB,GACL,OAAOA,EAAc,MAAO,CAC1BA,EAAc,MAAO,CACnBC,MAAO,CACLC,GAAK,aAAYC,KAAKN,aAK9BO,sBAlCJjB,iBACE,IACEC,IACA,MAAOiB,GAEPC,QAAQC,KADMF,GAAOA,EAAIG,QAAUH,EAAIG,QAAU,uBAC3BH,IA8BdI,MA1EZlC,EAAMmC,SAAS,aAEfpC,EAAUqC,KAAKC,KAAM,EAerB3B,EAAgB,EAAG4B,SAAAA,MACjBvC,EAAUwC,SAASC,QAAUF,EAC7BnC,EACE,0CACAmC,EACAzB,KAIJJ,IAEAgC,OAAOC,iBAAiB,aAAczC,GAmDzB0C,MAAAA,EAAa1B,EAAM,eACnB2B,EAAY3B,EAAM,cAClB4B,EAAoB5B,EAAM,uBAC1B6B,EAAe7B,EAAM,iBAErB8B,EAAY,CACvB9B,MAAAA,EACA0B,WAAAA,EACAC,UAAAA,EACAC,kBAAAA,EACAC,aAAAA,GAGF,IAAK,MAAME,KAAQrC,EACZoC,EAAUC,KAAOD,EAAUC,GAAQrC,EAAKqC"}