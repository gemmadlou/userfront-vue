{"version":3,"file":"userfront-vue.umd.js","sources":["../src/index.js"],"sourcesContent":["import Vue from \"vue\";\nimport AnyMod from \"@anymod/core\";\nimport Core from \"@userfront/core\";\n\nconst {\n  Singleton,\n  alias,\n  render,\n  processPage,\n  addScript1ToDocument,\n  createOrReturnPage,\n  checkPageAndUpdate,\n  executeCallbacks,\n  logErrorsAndTips,\n} = AnyMod;\n\nconst { registerUrlChangedEventListener, addInitCallback } = Core;\nalias.setAlias(\"Userfront\");\n\nSingleton.Opts.api = true;\n\n/**\n * The order of operations is:\n *  1. Userfront.init() is called\n *  2. Callback is fired that adds Script1 to document and sets Singleton.isScript1Loading = true\n *  3. Userfront.build() is called\n *  4. componentDidMount() is called\n *  5. mountTools() is called\n *  6a. If Script1 hasn't loaded yet, wait for it to load\n *  6b. If Script1 has loaded, continue\n *  7. runAnyModSetup() is called\n */\n\n// Callback to fire whenever Userfront.init is called\naddInitCallback(({ tenantId }) => {\n  Singleton.External.project = tenantId;\n  addScript1ToDocument(\n    \"https://mod.userfront.com/v3/page/\",\n    tenantId,\n    runAnyModSetup\n  );\n});\n\nregisterUrlChangedEventListener();\n\nwindow.addEventListener(\"urlchanged\", render);\n\nasync function runAnyModSetup() {\n  if (Singleton.isScript1Loading) return;\n  try {\n    const page = await createOrReturnPage();\n    const updatedPage = await checkPageAndUpdate(page);\n    await processPage(updatedPage);\n    executeCallbacks();\n    logErrorsAndTips();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function mountTools() {\n  try {\n    runAnyModSetup();\n  } catch (err) {\n    let message = err && err.message ? err.message : \"Problem loading page\";\n    console.warn(message, err);\n  }\n}\n\nfunction build() {\n  const name = `userfront-${Math.random().toString(36).substring(6)}`;\n  return Vue.component(name, {\n    props: {\n      id: {\n        type: String,\n        required: true,\n      },\n    },\n    template: `<div><div id=\"userfront-${this.id}\"></div></div>`,\n    async mounted() {\n      await mountTools();\n    },\n  });\n}\n\nconst Userfront = {\n  build,\n  SignupForm: build,\n  LoginForm: build,\n  PasswordResetForm: build,\n  LogoutButton: build,\n};\n\nfor (const attr in Core) {\n  if (!Userfront[attr]) Userfront[attr] = Core[attr];\n}\n\nexport default Userfront;\n"],"names":["runAnyModSetup","Singleton","isScript1Loading","body","recover","result","createOrReturnPage","page","checkPageAndUpdate","updatedPage","processPage","executeCallbacks","logErrorsAndTips","e","then","error","console","log","alias","render","addScript1ToDocument","AnyMod","registerUrlChangedEventListener","addInitCallback","Core","build","name","Math","random","toString","substring","Vue","component","props","id","type","String","required","template","this","mounted","err","warn","message","mountTools","setAlias","Opts","api","tenantId","External","project","window","addEventListener","Userfront","SignupForm","LoginForm","PasswordResetForm","LogoutButton","attr"],"mappings":"+fA+CeA,iBACb,GAAIC,EAAUC,iBAAkB,yBADF,QAmgBzB,SAAgBC,EAAMC,GAC5B,IACC,IAAIC,kBAlgBiBC,mBAAbC,0BACoBC,EAAmBD,kBAAvCE,0BACAC,EAAYD,oBAClBE,IACAC,UA+fD,MAAMC,GACP,OAAOT,EAAQS,GAEhB,OAAIR,GAAUA,EAAOS,KACbT,EAAOS,UAAK,EAAQV,GAErBC,cApgBGU,GACPC,QAAQC,IAAIF,wGApDVd,UACJA,EADIiB,MAEJA,EAFIC,OAGJA,EAHIT,YAIJA,EAJIU,qBAKJA,EALId,mBAMJA,EANIE,mBAOJA,EAPIG,iBAQJA,EARIC,iBASJA,GACES,GAEEC,gCAAEA,EAAFC,gBAAmCA,GAAoBC,EAqD7D,SAASC,IACP,MAAMC,EAAQ,aAAYC,KAAKC,SAASC,SAAS,IAAIC,UAAU,GAC/D,OAAOC,EAAIC,UAAUN,EAAM,CACzBO,MAAO,CACLC,GAAI,CACFC,KAAMC,OACNC,UAAU,IAGdC,SAAW,2BAA0BC,KAAKL,mBACpCM,6DAlBR,IACExC,IACA,MAAOyC,GAEPzB,QAAQ0B,KADMD,GAAOA,EAAIE,QAAUF,EAAIE,QAAU,uBAC3BF,GALE,4DAoBhBG,uBATiB,sCAtD7B1B,EAAM2B,SAAS,aAEf5C,EAAU6C,KAAKC,KAAM,EAerBxB,EAAgB,EAAGyB,SAAAA,MACjB/C,EAAUgD,SAASC,QAAUF,EAC7B5B,EACE,qCACA4B,EACAhD,KAIJsB,IAEA6B,OAAOC,iBAAiB,aAAcjC,GAwCtC,MAAMkC,EAAY,CAChB5B,MAAAA,EACA6B,WAAY7B,EACZ8B,UAAW9B,EACX+B,kBAAmB/B,EACnBgC,aAAchC,GAGhB,IAAK,MAAMiC,KAAQlC,EACZ6B,EAAUK,KAAOL,EAAUK,GAAQlC,EAAKkC"}